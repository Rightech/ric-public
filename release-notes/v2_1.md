# Rightech IoT Cloud v2.1
*03 августа 2020, команда Rightech* 
Этот релиз несет в себе много изменений, которые затронули большинство аспектов нашей платформы:  
Личный кабинет:  
* [создание и управление лицензиями](#создание-и-управление-лицензиями) - cоздание собственных лицензий, выбор и настройка их параметров.  

Автоматы:  
* [контроль нескольких объектов в одном автомате](#контроль-нескольких-объектов-в-одном-автомате) - написание сценариев, в которых участвует несколько объектов (пока до 4);
* [новые интерфейсы управления автоматами](#новые-интерфейсы-управления-автоматами) - новый интерфейс выбора и управления автоматами из сервиса Логика.

Модели:  
* [стартовые наборы](#модели) - готовые наборы, состоящие из модели, объекта автомата и и других сущностей для демонстрации возможностей платформы.
  
Протоколы:
* [MQTTv5.0](#mqtt-v50);
* [Galileosky](#galileosky);
* [Teltonika](#teltonika).

Объекты:  
* [история команд](#история-команд) - новый интерфейс для просмотра истории команд, отображающий их статус, время исполнения и другие характеристики;
* [статистика](#статистика) - новый интерфейс  для просмотра статистики объекта;
* [боты](#боты) - новая индикация ботов, переключатель типа объекта - бот/не бот.

Обработчики:
* [изменения интерфейса](#обработчики) - изменения интерфейса выбора параметров и выбора объектов.

Другие изменения:
* [API-токены](#api-токены) - расширение возможностей для postman, правки интерфейса;  
* [приветственное окно](#приветственное-окно) - новое окно со справочной информацией;
* [push-сообщения](#push-сообщения) - новые возможности индикации и отображения push-сообщений.

### Личный кабинет
##### Создание и управление лицензиями
В этом релизе нашим пользователям станет доступна возможность создания собственных лицензий, которые будут отвечать их потребностям. Для создания лицензии необходимо перейти в личный кабинет пользователя в меню Лицензии.

Созлание лицензии:  
![user profile](/.images/lic.gif)

Лицензии работают по подписке, где пользователь сам выбирает как период оплаты, так и основные параметры. Выбор параметров - это ответственная операция, которая требует понимания того, как вы хотите использовать платформу Rightech IoT Cloud для реализации своих IoT-идей. 

Перед началом работы рекомендуем протестировать и опробовать все возможности платформы на Базовой  лицензии, доступной всем пользователям. Созданную лицензию можно расширить в любой момент, изменив активную лицензию в личном кабинете. Подробнее об [условиях оплаты](https://rightech.io/payment-information/) и [условиях использования платформы Rightech IoT Cloud](https://rightech.io/wp-content/uploads/2020/07/Ru-Terms-of-Use-of-the-portal-and-the-platform-%C2%ABRightech-IoT-Cloud%C2%BB.pdf).

Кроме того мы приняли решение существенно расширить Базовую лицензию. Теперь в нее могут входить до 10 устройств (раньше было 2!). Также увеличен параметр “Размер пакета” с 130 до 256 Байт. Это позволит не только лучше познакомиться с возможностями платформы, но и создавать полноценные IoT-проекты, пользуясь только Базовой лицензией. Эти изменения автоматически применяются для всех пользователей.

### Автоматы
##### Контроль нескольких объектов в одном автомате
Теперь в автоматах появилась возможность использовать несколько объектов внутри одного сценария Логики. То есть можно организовать совместную работу объектов, которые подключены к платформе. Также можно реализовывать сценарии автоматизации работы разнородных устройств. Это позволяет более широко взглянуть на мир IoT, так как IoT — это именно взаимодействие между умными вещами.

Создание автомата с несколькими объектами:  
![create automaton](/.images/create_automaton.gif)
##### Новые интерфейсы управления автоматами
Мы изменили подход к элементам управления автоматами. Новые интерфейсы позволяют наглядно отображать текущие состояния как автомата, так и объекта, гибко управлять работой сценариев.

Интерфейс управления автоматами:  
![automaton table](/.images/table_automatons.gif)

Управление автоматами со страницы с объектами:  
![automaton of object](/.images/object_automatons.gif)

Генерация событий:  
![gen event](/.images/gen_event.gif)

⁣Для запущенного автомата появилась возможность сгенерировать событие. Кнопка “сгенерировать событие” предоставляет выбор из тех событий, которые могут привести к выходу из текущего состояния автомата. Это позволяет протестировать работу созданного автомата без необходимости воспроизведения реальных событий на устройстве или вызывать незамедлительное срабатывание таймера.

### Модели
###### Стартовые наборы
⁣Для лучшего погружения в платформу мы добавили стартовые наборы.

Это несколько готовых IoT кейсов на базе нашей платформы. Эти наборы включают в себя цифровую модель устройства, объект, сценарий логики. Благодаря этим готовым примерам, вы сможете быстро посмотреть как можно использовать платформу в реализации ваших идей. В дальнейшем, мы планируем расширять список стартовых наборов.

Создание модели:  
![model-page](/.images/model_page.png)

⁣Стартовый набор позволяет с легкостью сделать свой первый реальный проект на платформе, подключив устройство к созданному объекту. Вы можете использовать это решение сразу без изменений, либо скорректировать его под свое устройство или под свою логику.

В набор “умный светильник” входит модель для MQTT-устройства , объект, который может передавать данные о температуре и влажности, обработчик и автомат. Обработчик преобразует входные данные в эффективную температуру и температуру в градусах Кельвина, а автомат предназначен для оповещения пользователя о превышении установленных лимитов по температуре.

Стартовый набор “умный светильник”:  
![kit-light](/.images/starter_kit_1.png)

В набор “мониторинг транспорта” входит модель для оборудования, работающего по протоколу wialon ips v1.1 или v2.0, объект, геозона по границам МКАД и автомат, контролирующий въезд и выезд в эту геозону.

Стартовый набор “мониторинг транспорта”:  
![kit-auto](/.images/starter_kit_2.png)  

### Протоколы 
Мы продолжаем расширять список поддерживаемого оборудования. Из частной версии платформы в публичную были перенесены протоколы транспортной телематики Galileosky и Teltonika. Теперь они доступны всем пользователям! Помимо этого, мы расширили поддержку протокола MQTT до его актуальной версии v5.0.
##### MQTT v5.0
Добавили поддержку новой версии протокола MQTT. При использовании MQTTv5.0. стоит учитывать особенность нашей реализации:
* Не поддерживается флаг Retain.
* Не поддерживается флаг CleanSession.
* Не поддерживается срок действия сообщения.
* Осложнена работа с unicode. В интерфейсе нет инструментов для обработки и отображения таких данных. Будем работать над этой проблемой.
* Не до конца реализована работа с идентификаторами подписок.
* Не поддерживается расширенная авторизация (SCRAM-SHA-1, GS2-KRB5 и т.д.). Сейчас формируется ошибка в connack.
##### Galileosky
Устройства Galileosky предназначены для мониторинга за состоянием любых подвижных средств и применяются в различных кейсах от грузоперевозок и такси до контроля стиля вождения и каршеринга. Более подробную информацию о ГЛОНАСС/GPS терминалах мониторинга транспорта можно посмотреть на [сайте производителя](https://7gis.ru/).

⁣В нашей [документации](https://rightech.io/developers/example/galileosky/) описано как работать с этими терминалами с помощью платформы Rightech IoT Cloud.

##### Teltonika
Оборудование Teltonika может применяться как для мониторинга состояния автотранспортного средства, так и для организации более сложных проектов. Производитель предоставляет широкий ассортимент устройств, связанных как с транспортной телематикой, так и с другими направлениями IoT.

Более подробную информацию можно посмотреть на [сайте производителя](https://teltonika-gps.com/ru/)

В нашей [документации](https://rightech.io/developers/example/teltonika/) описано как работать с этими терминалами с помощью платформы Rightech IoT Cloud.

### Объекты
В этом релизе мы добавили новые возможности при работе с объектом.

##### История команд
![command-history](/.images/command_history.png)

История команд позволяет видеть все отправленные команды на устройства за выбранный период вместе с их результатом исполнения. Если развернуть конкретную команду, то можно увидеть ответ от устройства. 

##### Статистика
![statistics](/.images/stats.png)

Экран статистики позволяет по-другому взглянуть на активность объекта в платформе. В этом разделе можно следить за следующими параметрами подключенного устройства(в том числе и бота). Это поможет оценить поведение объекта.

##### Боты
Настройка и отображение объекта-бота:
![bots](/.images/bots.png)

В редактировании объекта появилась возможность выбрать тип объекта. Для этого необходимо выбрать значение параметра “Использовать как бот”. Бот — это внутренний инструмент в платформе Rightech IoT Cloud, позволяющий эмулировать работу своего IoT-устройства. Это помогает оценить возможности платформы без подключения реальных устройств и прототипировать свои IoT-идеи.

Если в данный момент подключен бот, то значок “онлайн” на карточке объекта будет обозначаться синим цветом.

**ВАЖНО:** Реальное устройство и бот, подключенные к одному объекту в платформе, будут мешать работе друг друга и выбивать свою копию. Это можно увидеть, когда постоянно меняется значение статуса “онлайн”. Такая же ситуация возникает, если подключено 2 устройства с одинаковым идентификатором.  
![bots-3](/.images/bot_offline.gif)

### Другие изменения
##### Обработчики
В этом сервисе исправления касались интерфейса выбора объектов и выбора параметров.
Теперь список объектов содержит информацию о работающем обработчике: статус и время последней обработки. Добавили более удобную панель инструментов управления обработчика.

В интерфейсе выбора параметров расширена информация о них, добавлены ссылки на модели и документацию.

##### Выбор объектов
![handler01](/.images/handler01.png)
##### Выбор параметров для обработчика
![handler02](/.images/handler02.png)

##### API-токены
Мы внесли небольшие правки в интерфейс управления API-токенами. 

Интерфейс создания API-токена:  
![token](/.images/token.png)

Появилась возможность экспортировать Postman коллекции и Postman-окружение(переменные окружения можно скачать только в момент издания токена!). О том как нужно использовать API-токены для использования в REST API  можно прочитать в [документации](https://rightech.io/developers/http-api/).

##### Приветственное окно
Добавлено приветственное окно, в котором содержится как ознакомительная информация о платформе, так и полезные ссылки на наши ресурсы и материалы. Это окно будет появляться при входе в платформу до тех пор, пока не включена соответствующая настройка. Также окно можно вызывать с помощью кнопки “Информация” на правой боковой панели платформы.
![start-page](/.images/start_page.png)

##### Push-сообщения
При наличии непрочитанных push-сообщений, для которых выбран тип “критический” на карточке объекта, будет отображен соответствующий индикатор. Клик на эту кнопку отфильтрует Push-сообщения по данному объекту.

Индикация критических Push-сообщений:  
![critical-push](/.images/critical_push.png)

Визуализация новых сообщений:  
![fade_in](/.images/push_fade_in.gif)

При появлении новых Push-сообщений, которые не проходят по выставленному фильтру, поле ввода на короткое время выделяется красным цветом. Данное нововведение было принято после получения фидбека от сообщества. Иногда при тестировании автомата у пользователя возникала ситуация, когда он ждет Push-сообщение, но из-за примененного фильтра сообщение не появляется в интерфейсе. Некоторых пользователей это приводило в замешательство.

---
С каждым новым релизом мы прислушиваемся к вашему фидбэку. Мы благодарим каждого, кто оставляет свои отзывы и предложения. Благодаря вам мы становимся лучше, продолжаем совершенствовать платформу, сохраняя при этом ее простоту  использования.
Присоединяйтесь к нашим соцсетям и осталяйте обратную связь! 

Следите за новостями на нашем [Telegram-канале](https://t.me/rightechportal). В [Telegram-чате](https://t.me/rightech_iot) можно познакомиться с единомышленниками и получить ответы на имеющиеся вопросы.

Полезные ссылки:

* [Документация](https://rightech.io/developers/introductions/)
* [Видеоуроки](https://rightech.io/video-tutorials/)
* [Github](https://github.com/Rightech)
* [Сообщество ВК](https://vk.com/rightech)
* [Сообщество Facebook](https://www.facebook.com/rightechllc/)