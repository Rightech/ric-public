# Rightech IoT Cloud v2.1
*29 июля 2020, команда Rightech*
Этот релиз несет в себе много изменений, которые затронули большинство аспектов нашей платформы:  
Личный кабинет:  
* [Создание и управление лицензиями](#создание-лицензии) - Создание собственных лицензий, выбор и настройка их параметров.  
* [API-токены](#api-токены) - Расширение возможностей для postman, правки интерфейса.  

Автоматы:  
* [контроль нескольких объектов в одном автомате](#контроль-нескольких-объектов-в-одном-автомате) - написание сценариев, в которых участвует несколько объектов (пока до 4)
* [управление запущенными автоматами](#управление-запущенными-автоматами) - новый интерфейс выбора и управления автоматами из сервиса Логика
* [страница управления запущенными автоматами объекта](#управление-запущенными-автоматами)] - новый интерфейс управления автоматами объекта
* [сгенерировать событие](#сгенерировать-событие) - возможность искусственно вызвать события для запущенного автомата 

Модели:  
* [стартовые наборы](#стартовые-наборы) - готовые наборы, состоящие из модели, объекта автомата и и других сущностей для демонстрации возможностей * платформы
* [протоколы](#протоколы) - новые протоколы Galileosky и Teltonika  

Объекты:  
* [история команд](#история-команд) - новый интерфейс для просмотра истории команд, отображающий их статус, время исполнения и другие характеристики.
* [статистика](#статистика) - новый интерфейс  для просмотра статистики объекта

Другие изменения:
* [боты](#боты) - новая индикация ботов, переключатель типа объекта - бот/не бот
* [Обработчики](#обработчики) - изменения интерфейса выбора параметров и выбора объектов;
* [Приветственное окно](#приветственное-окно) - новое окно со справочной информацией;
* [Push-сообщения](#push-сообщения) - новые возможности индикации и отображения push-сообщений.

Кроме того мы приняли решение существенно расширить Базовую лицензию. Теперь в нее могут входить до 10 объектов(раньше было 2!). Также увеличен параметр “Размер пакета” с 130 до 256 Байт. Это позволит не только лучше познакомится с возможностями платформы, но и создавать полноценные IoT-проекты, пользуясь только Базовой лицензией. Эти изменения автоматически применяются для всех пользователей.
Один из главных приоритетов нашей команды расширить список возможностей для пользователей и сделать наш продукт более доступным. Мы приглашаем пользователей присоединяться к нашим соцсетям и давать обратную связь, фиксировать проблемы и баги. 
### Личный кабинет
##### Создание и управление лицензиями
В этом релизе нашим пользователям станет доступна возможность создания собственных лицензий, которые будут отвечать их потребностям. Для создания лицензии необходимо перейти в личный кабинет пользователя в меню Лицензии.

Созлание лицензии:  
![user profile](/.images/lic.gif)

Лицензии работают по подписке, где пользователь сам выбирает как период оплаты, так и основные параметры. Выбор параметров - это ответственная операция, которая требует понимания того, как вы хотите использовать платформу Rightech IoT Cloud для реализации своих IoT-идей. Перед началом работы рекомендуем протестировать и опробовать все возможности платформы на Базовой  лицензии, доступной всем пользователям. Созданную лицензию можно расширить в любой момент, изменив активную лицензию в личном кабинете.   Подробнее об условиях оплаты и условиях использования платформы Rightech IoT Cloud.
### API-токены
Мы внесли небольшие правки в интерфейс управления API-токенами. 

Интерфейс создания API-токена:  
![token](/.images/token.png)

Появилась возможность экспортировать Postman коллекции и Postman-окружение(переменные окружения можно скачать только в момент издания токена!). О том как нужно использовать API-токены для использования в REST API  можно прочитать в документации.
### Автоматы
##### Контроль нескольких объектов в одном автомате
Теперь в автоматах появилась возможность использовать несколько объектов внутри одного сценария Логики. То есть можно организовать совместную работу объектов, которые подключены к платформе. Это позволяет правильно посмотреть на мир IoT. Ведь IoT - это именно взаимодействие между умными вещами. Можно реализовывать сценарии автоматизации работы разнородных устройств. 

Создание автомата с несколькими объектами:  
![create automaton](/.images/create_automaton_2.gif)

##### Управление запущенными автоматами
Новый UI таблицы выбора и управления автоматами

Таблица управления автоматами:  
![automaton table](/.images/table_automatons.gif)

В таблице теперь видна информация об объектах, для которых запущен этот автомат. Появилась возможность выбора активных автоматов из списка через ctrl+клик.
##### Страница управления запущенными автоматами объекта

Управление автоматами со страницы с объектами:  
![automaton of object](/.images/object_automatons.gif)

Переработали список автоматов на странице объекта. Расширили информацию об работающих автоматах. 
Сгенерировать событие:  
![gen event](/.images/gen_event.gif)

Для запущенного автомата появилась возможность сгенерировать событие. Кнопка “сгенерировать событие” предоставляет выбор из тех событий, которые могут привести к выходу из текущего состояния автомата. Это позволяет протестировать работу созданного автомата без необходимости воспроизведения реальных событий на устройстве или вызывать незамедлительное срабатывание таймера. 

### Модели
###### Стартовые наборы
Для лучшего погружения в платформу мы добавили возможность создания стартовых наборов. Предоставляемый стартовый набор - это пример IoT-проекта, который можно создать в платформе Rightech IoT Cloud. Стартовый набор включает в себя модель, объект, автоматы и другие сущности, которые могут входить в это решение.  

Создание модели:  
![model-page](/.images/model_page.png)

Сейчас пользователям доступно два набора.

Стартовый набор “умный светильник”:  
![kit-light](/.images/starter_kit_1.png)

В набор входит модель для MQTT-устройства "умный светильник", объект(бот), который может передавать данные о температуре и влажности, обработчик и автомат. Обработчик преобразует входные данные в эффективную температуру и температуру в градусах Кельвина. Автомат предназначен для оповещения пользователя о превышении установленных лимитов по температуре.

Стартовый набор “автомобильный”:  
![kit-auto](/.images/starter_kit_2.png)
В набор входит модель для оборудования, работающего по протоколу wialon ips v1.1 или v2.0, объект, геозона по границам МКАД и автомат контролирующий въезд и выезд в эту геозону.


### Протоколы 
Мы продолжаем расширять список поддерживаемых протоколов. На этот раз мы добавили новые протоколы транспортной телематики Galileosky и Teltonika. 
Galileosky
Устройства Galileosky предназначены для мониторинга за состоянием любых подвижных средств и применяются в различных кейсах от грузоперевозок и такси до контроля стиля вождения и каршеринга. Более подробную информацию о ГЛОНАСС/GPS терминалах мониторинга транспорта можно посмотреть на сайте производителя https://7gis.ru/. 
В нашей документации описано как работать с данными терминалами с помощью платформы Rightech IoT Cloud.
Teltonika
Оборудование Teltonika может применяться как для мониторинга состояния автотранспортного средства, так и для организации более сложных проектов. Производитель предоставляет широкий ассортимент устройств, связанных как с транспортной телематикой, так и с другими направлениями IoT.
Более подробную информацию можно посмотреть на сайте производителя:
IoT - https://teltonika-iot-group.com/ru/
GPS-трекеры - https://teltonika-gps.com/ru/
В нашей документации описано как работать с данными терминалами с помощью платформы Rightech IoT Cloud.

### Объекты
В этом релизе мы также добавили новые возможности при работе с объектом.

##### История команд
![command-history](/.images/command_history.png)

История команд позволяет видеть все отправленные команды на устройства за выбранный период вместе с их результатом исполнения. Если развернуть конкретную команду, то можно увидеть ответ от устройства. 

##### Статистика
![statistics](/.images/stats.png)

Экран статистики позволяет по-другому взглянуть на активность объекта в платформе. В этом разделе можно следить за следующими параметрами подключенного устройства(в том числе и бота). Это поможет оценить поведение объекта.

##### Боты
![bots](/.images/bots.png)

В редактировании объекта появилась возможность выбрать тип объекта. Для этого необходимо выбрать значение параметра “Использовать как бот”. Бот - это внутренний инструмент в платформе Rightech IoT Cloud, позволяющий эмулировать работу своего IoT-устройства. Это помогает оценить возможности платформы без подключения реальных устройств и прототипировать свои IoT-идеи. 
Если в данный момент подключен бот, то значок “онлайн” на карточке объекта будет обозначаться синим цветом.
ВАЖНО: Реальное устройство и бот, подключенные к одному объекту в платформе, будут мешать работе друг друга и выбивать свою копию. Это можно увидеть, когда постоянно меняется значение статуса “онлайн”. Такая же ситуация возникает, если подключено 2 устройства с одинаковым идентификатором.
### Обработчики
В этом сервисе исправления касались интерфейса выбора объектов и выбора параметров.

##### Выбор объектов
![handler01](/.images/handler01.png)
##### Выбор параметров 
![handler02](/.images/handler02.png)
### Другие изменения
##### Приветственное окно
![start-page](/.images/start_page.png)
Добавлено приветственное окно, в котором содержится как ознакомительная информация о платформе, так и полезные ссылки на наши ресурсы и материалы. Это окно будет появляться при входе в платформу до тех пор, пока не включена соответствующая настройка. Также окно можно вызывать с помощью кнопки “Информация” на правой боковой панели платформы

##### Push-сообщения
При наличии непрочитанных push-сообщений, для которых выбран тип “критический” на карточке объекта, будет отображен соответствующий индикатор. Клик на эту кнопку отфильтрует Push-сообщения по данному объекту.

Индикация критических Push-сообщений:  
![critical-push](/.images/critical_push.png)

Визуализация новых сообщений:
![fade_in](/.images/push_fade_in.gif)

При появлении новых Push-сообщений, которые не проходят по выставленному фильтру, поле ввода на короткое время выделяется красным цветом. Данное нововведение было принято после получения фидбека от сообщества. Иногда при тестировании автомата у пользователя возникала ситуация, когда он ждет Push-сообщение, но из-за примененного фильтра сообщение не появляется в интерфейсе. Некоторых пользователей это приводило в замешательство.
